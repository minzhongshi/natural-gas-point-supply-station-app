"use strict";const e=require("../../../common/vendor.js"),o=require("../../../api/user/index.js"),s={data:()=>({jobNumber:"",phone:"",second:0,send:!0,s:60,code:"",showPassword:!1,password:""}),onLoad(){},computed:{},onUnload(){},methods:{display(){this.showPassword=!this.showPassword},getcode(){if(11!=this.phone.length)return void e.index.showToast({icon:"none",title:"手机号不正确"});if(12!=this.jobNumber.length)return void e.index.showToast({icon:"none",title:"工号不正确"});if(!this.send)return!1;this.send=!1,e.index.request({url:o.API.USER_VERIFYCODE,data:{mobile:this.phone},method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},dataType:"json",success:o=>{200!=o.data.code?e.index.showToast({title:o.msg,icon:"none"}):(this.time,e.index.showToast({title:"发送成功",icon:"none",success:()=>{this.time()}}))}})},bindLogin(){11==this.phone.length?12==this.jobNumber.length?this.password.length<6?e.index.showToast({icon:"none",title:"密码不小于6位"}):6==this.code.length?e.index.request({url:o.API.USER_PASSWORD,data:{accountType:"APP",accountNumber:this.jobNumber,mobile:this.phone,password:this.password,verifyCoder:this.code},header:{"Content-Type":"application/json"},method:"POST",dataType:"json",success:o=>{console.log(o),200!=o.data.code?e.index.showToast({title:o.data.msg,icon:"none"}):(e.index.showToast({title:"修改成功"}),setTimeout((function(){e.index.navigateBack({delta:1})}),1500))}}):e.index.showToast({icon:"none",title:"验证码不正确"}):e.index.showToast({icon:"none",title:"工号不正确"}):e.index.showToast({icon:"none",title:"手机号不正确"})},time(){let e=this;e.second=e.s;let o=setInterval((function(){1==e.second?(e.send=!0,e.second=e.s,clearInterval(o)):e.second--}),1e3)}}};const t=e._export_sfc(s,[["render",function(o,s,t,n,i,d){return{a:i.jobNumber,b:e.o((e=>i.jobNumber=e.detail.value)),c:i.phone,d:e.o((e=>i.phone=e.detail.value)),e:!i.showPassword,f:i.password,g:e.o((e=>i.password=e.detail.value)),h:i.showPassword?"/static/img/shilu-login/op.png":"/static/img/shilu-login/cl.png",i:e.o(((...e)=>d.display&&d.display(...e))),j:i.code,k:e.o((e=>i.code=e.detail.value)),l:e.t(i.send?"发送验证码":i.second+"s重新发送"),m:i.send?"":1,n:e.o(((...e)=>d.getcode&&d.getcode(...e))),o:e.o((e=>d.bindLogin()))}}]]);wx.createPage(t);
