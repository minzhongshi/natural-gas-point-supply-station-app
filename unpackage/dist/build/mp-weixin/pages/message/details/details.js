"use strict";const e=require("../../../common/vendor.js"),a=require("../../../uni_modules/u-ajax/js_sdk/index.js"),t=require("../../../api/user/device.js"),s=require("../../../stores/counter.js");require("../../../uni_modules/u-ajax/js_sdk/lib/core/Ajax.js"),require("../../../uni_modules/u-ajax/js_sdk/lib/core/InterceptorManager.js"),require("../../../uni_modules/u-ajax/js_sdk/lib/helpers/buildURL.js"),require("../../../uni_modules/u-ajax/js_sdk/lib/utils.js"),require("../../../uni_modules/u-ajax/js_sdk/lib/helpers/mergeConfig.js"),require("../../../uni_modules/u-ajax/js_sdk/lib/core/dispatchRequest.js"),require("../../../uni_modules/u-ajax/js_sdk/lib/helpers/isCallback.js"),require("../../../uni_modules/u-ajax/js_sdk/lib/defaults.js"),require("../../../uni_modules/u-ajax/js_sdk/lib/adapters/http.js"),require("../../../uni_modules/u-ajax/js_sdk/lib/core/handleCancel.js"),require("../../../uni_modules/u-ajax/js_sdk/lib/adapters/Fetcher.js");const i=s.userAccountStore(),d={data:()=>({data:[]}),methods:{deleteMessage(){e.index.showModal({title:"提示",content:"确认已处理了吗？",success:s=>{s.confirm&&(e.index.showLoading({title:"清除中"}),a.ajax.post({url:t.API.DEVIE_DMESSAGE,data:{id:this.data.id}}).then((a=>{200===a.data.code?(this.getLog(),e.index.showToast({title:"处理成功",duration:2e3}),e.index.navigateBack({delta:1})):e.index.showToast({icon:"error",title:a.data.msg,duration:2e3}),e.index.hideLoading()})))}})},getLog(){a.ajax.post({url:t.API.DEVIE_LOG,data:{siteId:this.data.id,siteName:this.data.content,operationContent:`处理了一条来自${this.data.name}的消息`,operationName:i.information.username}}).then((a=>{200===a.data.code||e.index.showToast({icon:"error",title:"日志记录失败",duration:2e3})}))}},onLoad(e){let a=JSON.parse(decodeURIComponent(e.data));this.data=a,console.log(this.data)}};if(!Array){e.resolveComponent("uni-card")()}Math;const o=e._export_sfc(d,[["render",function(a,t,s,i,d,o){return e.e({a:e.t(this.data.content),b:this.data.video},this.data.video?{c:this.data.video,d:e.o(((...e)=>a.videoErrorCallback&&a.videoErrorCallback(...e)))}:{},{e:e.t(this.data.name),f:e.t(this.data.time),g:e.p({title:d.data.site,"sub-title":d.data.type,padding:"10px 0"}),h:e.o((e=>o.deleteMessage()))})}],["__scopeId","data-v-b44758e9"]]);wx.createPage(o);
